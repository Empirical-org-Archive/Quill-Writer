!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function Buffer(subject,encoding,noZero){if(!(this instanceof Buffer))return new Buffer(subject,encoding,noZero);var type=typeof subject;if("base64"===encoding&&"string"===type)for(subject=stringtrim(subject);subject.length%4!==0;)subject+="=";var length;if("number"===type)length=coerce(subject);else if("string"===type)length=Buffer.byteLength(subject,encoding);else{if("object"!==type)throw new Error("First argument needs to be a number, array or string.");length=coerce(subject.length)}var buf;Buffer._useTypedArrays?buf=Buffer._augment(new Uint8Array(length)):(buf=this,buf.length=length,buf._isBuffer=!0);var i;if(Buffer._useTypedArrays&&"number"==typeof subject.byteLength)buf._set(subject);else if(isArrayish(subject))for(i=0;length>i;i++)buf[i]=Buffer.isBuffer(subject)?subject.readUInt8(i):subject[i];else if("string"===type)buf.write(subject,0,encoding);else if("number"===type&&!Buffer._useTypedArrays&&!noZero)for(i=0;length>i;i++)buf[i]=0;return buf}function _hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining;var strLen=string.length;assert(strLen%2===0,"Invalid hex string"),length>strLen/2&&(length=strLen/2);for(var i=0;length>i;i++){var byte=parseInt(string.substr(2*i,2),16);assert(!isNaN(byte),"Invalid hex string"),buf[offset+i]=byte}return Buffer._charsWritten=2*i,i}function _utf8Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf8ToBytes(string),buf,offset,length);return charsWritten}function _asciiWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(asciiToBytes(string),buf,offset,length);return charsWritten}function _binaryWrite(buf,string,offset,length){return _asciiWrite(buf,string,offset,length)}function _base64Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(base64ToBytes(string),buf,offset,length);return charsWritten}function _utf16leWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf16leToBytes(string),buf,offset,length);return charsWritten}function _base64Slice(buf,start,end){return base64.fromByteArray(0===start&&end===buf.length?buf:buf.slice(start,end))}function _utf8Slice(buf,start,end){var res="",tmp="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)buf[i]<=127?(res+=decodeUtf8Char(tmp)+String.fromCharCode(buf[i]),tmp=""):tmp+="%"+buf[i].toString(16);return res+decodeUtf8Char(tmp)}function _asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(buf[i]);return ret}function _binarySlice(buf,start,end){return _asciiSlice(buf,start,end)}function _hexSlice(buf,start,end){var len=buf.length;(!start||0>start)&&(start=0),(!end||0>end||end>len)&&(end=len);for(var out="",i=start;end>i;i++)out+=toHex(buf[i]);return out}function _utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function _readUInt16(buf,offset,littleEndian,noAssert){noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+1<buf.length,"Trying to read beyond buffer length"));var len=buf.length;if(!(offset>=len)){var val;return littleEndian?(val=buf[offset],len>offset+1&&(val|=buf[offset+1]<<8)):(val=buf[offset]<<8,len>offset+1&&(val|=buf[offset+1])),val}}function _readUInt32(buf,offset,littleEndian,noAssert){noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"Trying to read beyond buffer length"));var len=buf.length;if(!(offset>=len)){var val;return littleEndian?(len>offset+2&&(val=buf[offset+2]<<16),len>offset+1&&(val|=buf[offset+1]<<8),val|=buf[offset],len>offset+3&&(val+=buf[offset+3]<<24>>>0)):(len>offset+1&&(val=buf[offset+1]<<16),len>offset+2&&(val|=buf[offset+2]<<8),len>offset+3&&(val|=buf[offset+3]),val+=buf[offset]<<24>>>0),val}}function _readInt16(buf,offset,littleEndian,noAssert){noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+1<buf.length,"Trying to read beyond buffer length"));var len=buf.length;if(!(offset>=len)){var val=_readUInt16(buf,offset,littleEndian,!0),neg=32768&val;return neg?-1*(65535-val+1):val}}function _readInt32(buf,offset,littleEndian,noAssert){noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"Trying to read beyond buffer length"));var len=buf.length;if(!(offset>=len)){var val=_readUInt32(buf,offset,littleEndian,!0),neg=2147483648&val;return neg?-1*(4294967295-val+1):val}}function _readFloat(buf,offset,littleEndian,noAssert){return noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(offset+3<buf.length,"Trying to read beyond buffer length")),ieee754.read(buf,offset,littleEndian,23,4)}function _readDouble(buf,offset,littleEndian,noAssert){return noAssert||(assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(offset+7<buf.length,"Trying to read beyond buffer length")),ieee754.read(buf,offset,littleEndian,52,8)}function _writeUInt16(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+1<buf.length,"trying to write beyond buffer length"),verifuint(value,65535));var len=buf.length;if(!(offset>=len))for(var i=0,j=Math.min(len-offset,2);j>i;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function _writeUInt32(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"trying to write beyond buffer length"),verifuint(value,4294967295));var len=buf.length;if(!(offset>=len))for(var i=0,j=Math.min(len-offset,4);j>i;i++)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function _writeInt16(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+1<buf.length,"Trying to write beyond buffer length"),verifsint(value,32767,-32768));var len=buf.length;offset>=len||(value>=0?_writeUInt16(buf,value,offset,littleEndian,noAssert):_writeUInt16(buf,65535+value+1,offset,littleEndian,noAssert))}function _writeInt32(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"Trying to write beyond buffer length"),verifsint(value,2147483647,-2147483648));var len=buf.length;offset>=len||(value>=0?_writeUInt32(buf,value,offset,littleEndian,noAssert):_writeUInt32(buf,4294967295+value+1,offset,littleEndian,noAssert))}function _writeFloat(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+3<buf.length,"Trying to write beyond buffer length"),verifIEEE754(value,3.4028234663852886e38,-3.4028234663852886e38));var len=buf.length;offset>=len||ieee754.write(buf,value,offset,littleEndian,23,4)}function _writeDouble(buf,value,offset,littleEndian,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert("boolean"==typeof littleEndian,"missing or invalid endian"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset+7<buf.length,"Trying to write beyond buffer length"),verifIEEE754(value,1.7976931348623157e308,-1.7976931348623157e308));var len=buf.length;offset>=len||ieee754.write(buf,value,offset,littleEndian,52,8)}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function clamp(index,len,defaultValue){return"number"!=typeof index?defaultValue:(index=~~index,index>=len?len:index>=0?index:(index+=len,index>=0?index:0))}function coerce(length){return length=~~Math.ceil(+length),0>length?0:length}function isArray(subject){return(Array.isArray||function(subject){return"[object Array]"===Object.prototype.toString.call(subject)})(subject)}function isArrayish(subject){return isArray(subject)||Buffer.isBuffer(subject)||subject&&"object"==typeof subject&&"number"==typeof subject.length}function toHex(n){return 16>n?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(str){for(var byteArray=[],i=0;i<str.length;i++){var b=str.charCodeAt(i);if(127>=b)byteArray.push(str.charCodeAt(i));else{var start=i;b>=55296&&57343>=b&&i++;for(var h=encodeURIComponent(str.slice(start,i+1)).substr(1).split("%"),j=0;j<h.length;j++)byteArray.push(parseInt(h[j],16))}}return byteArray}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;i++)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str){for(var c,hi,lo,byteArray=[],i=0;i<str.length;i++)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(str)}function blitBuffer(src,dst,offset,length){for(var i=0;length>i&&!(i+offset>=dst.length||i>=src.length);i++)dst[i+offset]=src[i];return i}function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}function verifuint(value,max){assert("number"==typeof value,"cannot write a non-number as a number"),assert(value>=0,"specified a negative value for writing an unsigned value"),assert(max>=value,"value is larger than maximum value for type"),assert(Math.floor(value)===value,"value has a fractional component")}function verifsint(value,max,min){assert("number"==typeof value,"cannot write a non-number as a number"),assert(max>=value,"value larger than maximum allowed value"),assert(value>=min,"value smaller than minimum allowed value"),assert(Math.floor(value)===value,"value has a fractional component")}function verifIEEE754(value,max,min){assert("number"==typeof value,"cannot write a non-number as a number"),assert(max>=value,"value larger than maximum allowed value"),assert(value>=min,"value smaller than minimum allowed value")}function assert(test,message){if(!test)throw new Error(message||"Failed assertion")}var base64=require("base64-js"),ieee754=require("ieee754");exports.Buffer=Buffer,exports.SlowBuffer=Buffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192,Buffer._useTypedArrays=function(){try{var buf=new ArrayBuffer(0),arr=new Uint8Array(buf);return arr.foo=function(){return 42},42===arr.foo()&&"function"==typeof arr.subarray}catch(e){return!1}}(),Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.isBuffer=function(b){return!(null===b||void 0===b||!b._isBuffer)},Buffer.byteLength=function(str,encoding){var ret;switch(str+="",encoding||"utf8"){case"hex":ret=str.length/2;break;case"utf8":case"utf-8":ret=utf8ToBytes(str).length;break;case"ascii":case"binary":case"raw":ret=str.length;break;case"base64":ret=base64ToBytes(str).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=2*str.length;break;default:throw new Error("Unknown encoding")}return ret},Buffer.concat=function(list,totalLength){if(assert(isArray(list),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===list.length)return new Buffer(0);if(1===list.length)return list[0];var i;if("number"!=typeof totalLength)for(totalLength=0,i=0;i<list.length;i++)totalLength+=list[i].length;var buf=new Buffer(totalLength),pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos),pos+=item.length}return buf},Buffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset))isFinite(length)||(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=length,length=swap}offset=Number(offset)||0;var remaining=this.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining,encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case"hex":ret=_hexWrite(this,string,offset,length);break;case"utf8":case"utf-8":ret=_utf8Write(this,string,offset,length);break;case"ascii":ret=_asciiWrite(this,string,offset,length);break;case"binary":ret=_binaryWrite(this,string,offset,length);break;case"base64":ret=_base64Write(this,string,offset,length);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=_utf16leWrite(this,string,offset,length);break;default:throw new Error("Unknown encoding")}return ret},Buffer.prototype.toString=function(encoding,start,end){var self=this;if(encoding=String(encoding||"utf8").toLowerCase(),start=Number(start)||0,end=void 0!==end?Number(end):end=self.length,end===start)return"";var ret;switch(encoding){case"hex":ret=_hexSlice(self,start,end);break;case"utf8":case"utf-8":ret=_utf8Slice(self,start,end);break;case"ascii":ret=_asciiSlice(self,start,end);break;case"binary":ret=_binarySlice(self,start,end);break;case"base64":ret=_base64Slice(self,start,end);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=_utf16leSlice(self,start,end);break;default:throw new Error("Unknown encoding")}return ret},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.copy=function(target,target_start,start,end){var source=this;if(start||(start=0),end||0===end||(end=this.length),target_start||(target_start=0),end!==start&&0!==target.length&&0!==source.length){assert(end>=start,"sourceEnd < sourceStart"),assert(target_start>=0&&target_start<target.length,"targetStart out of bounds"),assert(start>=0&&start<source.length,"sourceStart out of bounds"),assert(end>=0&&end<=source.length,"sourceEnd out of bounds"),end>this.length&&(end=this.length),target.length-target_start<end-start&&(end=target.length-target_start+start);var len=end-start;if(100>len||!Buffer._useTypedArrays)for(var i=0;len>i;i++)target[i+target_start]=this[i+start];else target._set(this.subarray(start,start+len),target_start)}},Buffer.prototype.slice=function(start,end){var len=this.length;if(start=clamp(start,len,0),end=clamp(end,len,len),Buffer._useTypedArrays)return Buffer._augment(this.subarray(start,end));for(var sliceLen=end-start,newBuf=new Buffer(sliceLen,void 0,!0),i=0;sliceLen>i;i++)newBuf[i]=this[i+start];return newBuf},Buffer.prototype.get=function(offset){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(offset)},Buffer.prototype.set=function(v,offset){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(v,offset)},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||(assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset<this.length,"Trying to read beyond buffer length")),offset>=this.length?void 0:this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return _readUInt16(this,offset,!0,noAssert)},Buffer.prototype.readUInt16BE=function(offset,noAssert){return _readUInt16(this,offset,!1,noAssert)},Buffer.prototype.readUInt32LE=function(offset,noAssert){return _readUInt32(this,offset,!0,noAssert)},Buffer.prototype.readUInt32BE=function(offset,noAssert){return _readUInt32(this,offset,!1,noAssert)},Buffer.prototype.readInt8=function(offset,noAssert){if(noAssert||(assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset<this.length,"Trying to read beyond buffer length")),!(offset>=this.length)){var neg=128&this[offset];return neg?-1*(255-this[offset]+1):this[offset]}},Buffer.prototype.readInt16LE=function(offset,noAssert){return _readInt16(this,offset,!0,noAssert)},Buffer.prototype.readInt16BE=function(offset,noAssert){return _readInt16(this,offset,!1,noAssert)},Buffer.prototype.readInt32LE=function(offset,noAssert){return _readInt32(this,offset,!0,noAssert)},Buffer.prototype.readInt32BE=function(offset,noAssert){return _readInt32(this,offset,!1,noAssert)},Buffer.prototype.readFloatLE=function(offset,noAssert){return _readFloat(this,offset,!0,noAssert)},Buffer.prototype.readFloatBE=function(offset,noAssert){return _readFloat(this,offset,!1,noAssert)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return _readDouble(this,offset,!0,noAssert)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return _readDouble(this,offset,!1,noAssert)},Buffer.prototype.writeUInt8=function(value,offset,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset<this.length,"trying to write beyond buffer length"),verifuint(value,255)),offset>=this.length||(this[offset]=value)},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){_writeUInt16(this,value,offset,!0,noAssert)},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){_writeUInt16(this,value,offset,!1,noAssert)},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){_writeUInt32(this,value,offset,!0,noAssert)},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){_writeUInt32(this,value,offset,!1,noAssert)},Buffer.prototype.writeInt8=function(value,offset,noAssert){noAssert||(assert(void 0!==value&&null!==value,"missing value"),assert(void 0!==offset&&null!==offset,"missing offset"),assert(offset<this.length,"Trying to write beyond buffer length"),verifsint(value,127,-128)),offset>=this.length||(value>=0?this.writeUInt8(value,offset,noAssert):this.writeUInt8(255+value+1,offset,noAssert))},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){_writeInt16(this,value,offset,!0,noAssert)},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){_writeInt16(this,value,offset,!1,noAssert)},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){_writeInt32(this,value,offset,!0,noAssert)},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){_writeInt32(this,value,offset,!1,noAssert)},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){_writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){_writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){_writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){_writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.fill=function(value,start,end){if(value||(value=0),start||(start=0),end||(end=this.length),"string"==typeof value&&(value=value.charCodeAt(0)),assert("number"==typeof value&&!isNaN(value),"value is not a number"),assert(end>=start,"end < start"),end!==start&&0!==this.length){assert(start>=0&&start<this.length,"start out of bounds"),assert(end>=0&&end<=this.length,"end out of bounds");for(var i=start;end>i;i++)this[i]=value}},Buffer.prototype.inspect=function(){for(var out=[],len=this.length,i=0;len>i;i++)if(out[i]=toHex(this[i]),i===exports.INSPECT_MAX_BYTES){out[i+1]="...";break}return"<Buffer "+out.join(" ")+">"},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer._useTypedArrays)return new Buffer(this).buffer;for(var buf=new Uint8Array(this.length),i=0,len=buf.length;len>i;i+=1)buf[i]=this[i];return buf.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(arr){return arr._isBuffer=!0,arr._get=arr.get,arr._set=arr.set,arr.get=BP.get,arr.set=BP.set,arr.write=BP.write,arr.toString=BP.toString,arr.toLocaleString=BP.toString,arr.toJSON=BP.toJSON,arr.copy=BP.copy,arr.slice=BP.slice,arr.readUInt8=BP.readUInt8,arr.readUInt16LE=BP.readUInt16LE,arr.readUInt16BE=BP.readUInt16BE,arr.readUInt32LE=BP.readUInt32LE,arr.readUInt32BE=BP.readUInt32BE,arr.readInt8=BP.readInt8,arr.readInt16LE=BP.readInt16LE,arr.readInt16BE=BP.readInt16BE,arr.readInt32LE=BP.readInt32LE,arr.readInt32BE=BP.readInt32BE,arr.readFloatLE=BP.readFloatLE,arr.readFloatBE=BP.readFloatBE,arr.readDoubleLE=BP.readDoubleLE,arr.readDoubleBE=BP.readDoubleBE,arr.writeUInt8=BP.writeUInt8,arr.writeUInt16LE=BP.writeUInt16LE,arr.writeUInt16BE=BP.writeUInt16BE,arr.writeUInt32LE=BP.writeUInt32LE,arr.writeUInt32BE=BP.writeUInt32BE,arr.writeInt8=BP.writeInt8,arr.writeInt16LE=BP.writeInt16LE,arr.writeInt16BE=BP.writeInt16BE,arr.writeInt32LE=BP.writeInt32LE,arr.writeInt32BE=BP.writeInt32BE,arr.writeFloatLE=BP.writeFloatLE,arr.writeFloatBE=BP.writeFloatBE,arr.writeDoubleLE=BP.writeDoubleLE,arr.writeDoubleBE=BP.writeDoubleBE,arr.fill=BP.fill,arr.inspect=BP.inspect,arr.toArrayBuffer=BP.toArrayBuffer,arr}},{"base64-js":2,ieee754:3}],2:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(exports){"use strict";function decode(elt){var code=elt.charCodeAt(0);return code===PLUS?62:code===SLASH?63:NUMBER>code?-1:NUMBER+10>code?code-NUMBER+26+26:UPPER+26>code?code-UPPER:LOWER+26>code?code-LOWER+26:void 0}function b64ToByteArray(b64){function push(v){arr[L++]=v}var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0,arr=new Arr(3*b64.length/4-placeHolders),l=placeHolders>0?b64.length-4:b64.length;var L=0;for(i=0,j=0;l>i;i+=4,j+=3)tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3)),push((16711680&tmp)>>16),push((65280&tmp)>>8),push(255&tmp);return 2===placeHolders?(tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4,push(255&tmp)):1===placeHolders&&(tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2,push(tmp>>8&255),push(255&tmp)),arr}function uint8ToBase64(uint8){function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(63&num)}var i,temp,length,extraBytes=uint8.length%3,output="";for(i=0,length=uint8.length-extraBytes;length>i;i+=3)temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output+=tripletToBase64(temp);switch(extraBytes){case 1:temp=uint8[uint8.length-1],output+=encode(temp>>2),output+=encode(temp<<4&63),output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1],output+=encode(temp>>10),output+=encode(temp>>4&63),output+=encode(temp<<2&63),output+="="}return output}var Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,PLUS="+".charCodeAt(0),SLASH="/".charCodeAt(0),NUMBER="0".charCodeAt(0),LOWER="a".charCodeAt(0),UPPER="A".charCodeAt(0);exports.toByteArray=b64ToByteArray,exports.fromByteArray=uint8ToBase64}("undefined"==typeof exports?this.base64js={}:exports)},{}],3:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?0/0:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=0>value||0===value&&0>1/value?1:0;for(value=Math.abs(value),isNaN(value)||1/0===value?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],4:[function(require){var sfHome=require("./home/"),sfGame=require("./game/"),sfForm=require("./form/"),sfFormLink=require("./form/link/"),sfLobby=require("./lobby/"),sfSample=require("./sample/"),sfMyactivity=require("./myactivity/"),sfLink=require("./link/"),sfCommon=require("./../common/"),sfConstants=require("./../common/constants");angular.module("stories-with-friends",[sfHome,sfGame,sfLobby,sfSample,sfLink,sfMyactivity,sfForm,sfFormLink,sfCommon,sfConstants,"firebase","ui.router","mgcrea.ngStrap","underscore","LocalStorageModule","angulartics","angulartics.mixpanel","uuid4","ngClipboard"]).config(function($stateProvider,$urlRouterProvider,ngClipProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("sf",{"abstract":!0,views:{header:{template:"<sf-header></sf-header>"},content:{template:"<div>Main Content</div>"},footer:{template:"<sf-footer></sf-footer>"}}}),ngClipProvider.setPath("//cdnjs.cloudflare.com/ajax/libs/zeroclipboard/2.1.6/ZeroClipboard.swf")})},{"./../common/":17,"./../common/constants":16,"./form/":5,"./form/link/":6,"./game/":7,"./home/":8,"./link/":9,"./lobby/":10,"./myactivity/":11,"./sample/":12}],5:[function(require,module){(function(Buffer){angular.module("sf.form",["ui.router"]).config(function($stateProvider){$stateProvider.state("sf.form",{url:"/form?uid",views:{"content@":{template:Buffer("PGRpdiBjbGFzcz0icm93Ij4KICA8Zm9ybSBjbGFzcz0iY3NzLWZvcm0iIG5vdmFsaWRhdGU+CiAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImZvcm0tY29udHJvbCBpbnB1dC1sZyIgbmctbW9kZWw9ImZvcm0uY3VycmVudEZvcm0ubmFtZSIgcGxhY2Vob2xkZXI9Ik5hbWUiIC8+CiAgICA8YnIvPgogICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJmb3JtLWNvbnRyb2wgaW5wdXQtbGciIG5nLW1vZGVsPSJmb3JtLmN1cnJlbnRGb3JtLnByb21wdCIgcGxhY2Vob2xkZXI9IlByb21wdCIgLz4KICAgIDxoMz5Xb3JkcyB3aXRoIERlZmluaXRpb248L2gzPgogICAgPGRpdiBjbGFzcz0iY29sLW1kLW9mZnNldC0xIj4KICAgICAgPGRpdiBuZy1yZXBlYXQ9IndvcmRUdXAgaW4gZm9ybS5jdXJyZW50Rm9ybS53b3JkTGlzdCI+CiAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJmb3JtLWNvbnRyb2wiIG5nLW1vZGVsPSJ3b3JkVHVwLndvcmQiIHBsYWNlaG9sZGVyPSJXb3JkIiAvPgogICAgICAgIDxici8+CiAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJmb3JtLWNvbnRyb2wiIG5nLW1vZGVsPSJ3b3JkVHVwLmRlZmluaXRpb24iIHBsYWNlaG9sZGVyPSJEZWZpbml0aW9uIiAvPgogICAgICAgIDxici8+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi13YXJuaW5nIiBuZy1jbGljaz0nZm9ybS5yZW1vdmVXb3JkKHdvcmRUdXApJyByb2xlPSJidXR0b24iPlJlbW92ZSB7e3dvcmRUdXAud29yZH19PC9idXR0b24+CiAgICAgICAgPGJyLz4KICAgICAgICA8YnIvPgogICAgICA8L2Rpdj4KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiByb2xlPSJidXR0b24iIG5nLWNsaWNrPSdmb3JtLmFkZE5ld1dvcmQoKSc+QWRkIEFub3RoZXIgV29yZDwvYnV0dG9uPgogICAgPC9kaXY+CiAgICA8YnIvPgogICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJmb3JtLWNvbnRyb2wgaW5wdXQtbGciIG5nLW1vZGVsPSJmb3JtLmN1cnJlbnRGb3JtLnJlcXVpcmVtZW50cy5uZWVkZWQiIHBsYWNlaG9sZGVyPSJOdW1iZXIgb2YgV29yZHMgTmVlZGVkIi8+CiAgICA8YnIgLz4KICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tcHJpbWFyeSBidG4tbGciIHJvbGU9ImJ1dHRvbiIgbmctY2xpY2s9J2Zvcm0uc3VibWl0Rm9ybShmb3JtLmN1cnJlbnRGb3JtKScgbmctZGlzYWJsZWQ9ImZvcm0uJGludmFsaWQiPlN1Ym1pdCBBY3Rpdml0eTwvYnV0dG9uPgogIDwvZm9ybT4KCiAgPGJyIC8+CiAgPGRpdiBuZy1zaG93PSdmb3JtLm1lc3NhZ2UnIGNsYXNzPSJyb3cgd2VsbCI+CiAgICA8cD57e2Zvcm0ubWVzc2FnZX19PC9wPgogIDwvZGl2Pgo8L2Rpdj4K","base64"),controller:"FormCtrl as form"}}})}).controller("FormCtrl",function($state,Form){var form=this;form.currentForm={},form.currentForm.wordList=[{}],form.submitForm=function(f){Form.submit(f,function(err,refName){err?form.message=err:(form.link="https://quill-writer.firebaseapp.com/#/myactivity/"+refName,$state.data||($state.data={}),$state.data.link=form.link,$state.transitionTo("sf.form.link"))})},form.addNewWord=function(){form.currentForm.wordList.push({})},form.removeWord=function(wordTup){var index=form.currentForm.wordList.indexOf(wordTup);form.currentForm.wordList.splice(index,1)}}),module.exports="sf.form"}).call(this,require("buffer").Buffer)},{buffer:1}],6:[function(require,module){(function(Buffer){angular.module("sf.form.link",["ui.router"]).config(function($stateProvider){$stateProvider.state("sf.form.link",{url:"/link",views:{"content@":{template:Buffer("PGRpdiBjbGFzcz0icm93Ij4KICA8ZGl2IGNsYXNzPSJyb3cgd2VsbCI+CiAgICA8aDI+TXkgQ3JlYXRlZCBBY3Rpdml0eTwvaDI+CiAgICA8cD5TaGFyZSB0aGlzIGxpbmsgd2l0aCB5b3VyIHN0dWRlbnRzLiBXaGVuIGEgc3R1ZGVudCBvcGVucyB0aGUgbGluaywKICAgIHRoZSBzdHVkZW50IGdlbmVyYXRlcyBhIHNlY29uZCBsaW5rIGZvciB0aGUgcGFydG5lci4gVGhlIHN0dWRlbnQgbXVzdAogICAgc2hhcmUgdGhlIGxpbmsgd2l0aCB0aGUgcGFydG5lciB0byBwbGF5IHRvZ2V0aGVyLiI8L3A+CiAgICA8cCBjbGFzcz0iaXRhbGljIj5UaGlzIGlzIGEgdGVtcG9yYXJ5IHN5c3RlbSB3aGlsZSB3ZSBpbnRlZ3JhdGUKICAgIFF1aWxsIFdyaXRlciBpbnRvIFF1aWxsLm9yZzwvcD4KICAgIDxhIGhyZWY9Int7Zm9ybUxpbmsubGlua319Ij57e2Zvcm1MaW5rLmxpbmt9fTwvYT4KICAgIDxici8+CiAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkgYnRuLXN1Ym1pdCIgY2xpcC1jb3B5PSJmb3JtTGluay5nZXRMaW5rKCkiCiAgICAgIGNsaXAtY2xpY2s9ImZvcm1MaW5rLmdldExpbmsoKSIKICAgICAgY2xpcC1jbGljay1mYWxsYmFjaz0iZm9ybUxpbmsuZmFsbGJhY2soZm9ybUxpbmsuZ2V0TGluaygpKSI+Q29weSBMaW5rPC9idXR0b24+CiAgPC9kaXY+CjwvZGl2Pgo=","base64"),controller:"FormLinkCtrl as formLink"}}})}).controller("FormLinkCtrl",function($state){var formLink=this;return $state.data&&$state.data.link?(formLink.link=$state.data.link,formLink.getLink=function(){return console.log("Going to copy %s",formLink.link),formLink.link},void(formLink.fallback=function(copy){window.prompt("Press cmd+c(Mac) or ctrl-c(Windows) to copy the text below.",copy)})):void $state.go("sf.form")}),module.exports="sf.form.link"}).call(this,require("buffer").Buffer)},{buffer:1}],7:[function(require,module){(function(Buffer){{var profanityFilter=require("./../../common/services/profanity-filter/"),punctuation=require("./../../common/services/punctuation/");require("./../../common/services/game/")}angular.module("sf.game",["ui.router",profanityFilter,punctuation,"ngSanitize"]).config(function($stateProvider){$stateProvider.state("sf.game",{url:"/games?uid&sid&activityPrompt",views:{"content@":{template:Buffer("PGRpdiBjbGFzcz0icm93Ij4KICA8ZGl2IGNsYXNzPSJjb2wtbWQtMyI+CiAgICA8ZGl2IGNsYXNzPSJ3ZWxsIHNpZGUtYmFyIj4KICAgICAgPGgzPkF1dGhvcnM8L2gzPgogICAgICA8dWwgY2xhc3M9Im5vLXBvaW50cyI+CiAgICAgICAgPGxpIG5nLXJlcGVhdD0ndXNlciBpbiBnYW1lLmN1cnJlbnRHYW1lLnVzZXJzJz4KICAgICAgICAgIDxwIG5nLWNsYXNzPSJ7J2FjdGl2ZSc6IHVzZXIuaXNUaGVpclR1cm59Ij57e3VzZXIubmFtZX19IDxzcGFuIG5nLXNob3c9ImdhbWUuaXNZb3UodXNlcikiPihZb3UpPC9zcGFuPjwvcD4KICAgICAgICA8L2xpPgogICAgICA8L3VsPgogICAgICA8aDM+U3RvcnkgV29yZHM8L2gzPgogICAgICA8dWwgY2xhc3M9Im5vLXBvaW50cyI+CiAgICAgICAgPGxpIG5nLXJlcGVhdD0naXRlbSBpbiBnYW1lLmN1cnJlbnRHYW1lLndvcmRMaXN0JwogICAgICAgICAgIGRhdGEtdGl0bGU9Int7aXRlbS5kZWZpbml0aW9ufX0iCiAgICAgICAgICAgZGF0YS1wbGFjZW1lbnQ9InJpZ2h0IgogICAgICAgICAgIGJzLXRvb2x0aXA+CiAgICAgICAgICA8cCBuZy1jbGFzcz0ieydzdHJpa2VkJzogZ2FtZS5pc1dvcmRVc2VkKGl0ZW0ud29yZCl9Ij57e2l0ZW0ud29yZH19PC9wPgogICAgICAgIDwvbGk+CiAgICAgICAgPC91bD4KICAgICAgPGgzPkdvYWxzPC9oMz4KICAgICAgPHAgPldvcmRzIHVzZWQge3tnYW1lLmN1cnJlbnRHYW1lLndvcmRzVXNlZExlbmd0aC5sZW5ndGh9fSBvZiB7e2dhbWUuY3VycmVudEdhbWUucmVxdWlyZW1lbnRzLm5lZWRlZH19PC9wPgogICAgPC9kaXY+CiAgPC9kaXY+CiAgPGRpdiBjbGFzcz0iY29sLW1kLW9mZnNldC0xIGNvbC1tZC03Ij4KICAgIDxkaXYgY2xhc3M9IndlbGwgaW52aXRlLXBhcnRuZXIiIG5nLXNob3c9ImdhbWUuY3VycmVudEdhbWUucGFydG5lckRpdlNob3ciPgogICAgICA8c3BhbiBjbGFzcz0iY2xvc2UiIG5nLWNsaWNrPSJnYW1lLmNsb3NlUGFydG5lclVSTERpdigpIj5YPC9zcGFuPgogICAgICA8aDI+SW52aXRlIFlvdXIgUGFydG5lcjwvaDI+CiAgICAgIDxwPlNlbmQgdGhpcyBsaW5rIHRvIHlvdXIgcGFydG5lciBzbyB0aGF0IHlvdSBhbmQgeW91ciBwYXJ0bmVyIGNhbiBqb2luIHRoZSBzYW1lIGdhbWUuCiAgICAgIE9uZSBwZXJzb24gc2hvdWxkIHNoYXJlIHRoZSBsaW5rLCBhbmQgdGhlIG90aGVyIHBlcnNvbiBzaG91bGQgcHJlc3MgdGhlIHN0YXJ0IGdhbWUgYnV0dG9uLjwvcD4KICAgICAgPGEgaHJlZj0ie3tnYW1lLmN1cnJlbnRHYW1lLnBhcnRuZXJVUkx9fSI+e3tnYW1lLmN1cnJlbnRHYW1lLnBhcnRuZXJVUkx9fTwvYT4KICAgICAgPGJyLz4KICAgICAgPGJyLz4KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1jb3B5IiBjbGlwLWNvcHk9ImdhbWUuY3VycmVudEdhbWUucGFydG5lclVSTCIKICAgICAgICBjbGlwLWNsaWNrPSJnYW1lLmdldFBhcnRuZXJVUkwoKSIKICAgICAgICBjbGlwLWNsaWNrLWZhbGxiYWNrPSJnYW1lLmZhbGxiYWNrKGdhbWUuZ2V0UGFydG5lclVSTCgpKSI+Q29weSBMaW5rPC9idXR0b24+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9IndlbGwgc3RhdGljLXR1dG9yaWFsIiBuZy1zaG93PSJnYW1lLmN1cnJlbnRHYW1lLmluc3RydWN0aW9uRGl2U2hvdyI+CiAgICAgIDxzcGFuIGNsYXNzPSJjbG9zZSIgbmctY2xpY2s9ImdhbWUuY2xvc2VJbnN0cnVjdGlvbkRpdigpIj5YPC9zcGFuPgogICAgICA8cD5UYWtlIHR1cm5zIHdyaXRpbmcgc2VudGVuY2VzIHVzaW5nIFN0b3J5IFdvcmRzLjwvcD4KICAgICAgPHA+WW91IGNhbiB1c2UgdGhlIHBhc3QsIHByZXNlbnQsIG9yIGZ1dHVyZSB0ZW5zZSBvZiBTdG9yeSBXb3Jkcy48L3A+CiAgICAgIDxwPkhvdmVyIHlvdXIgY3Vyc29yIG92ZXIgKG9yIGlmIG9uIG1vYmlsZSBkZXZpY2UsIHRhcCkgdGhlIFN0b3J5IFdvcmRzIHRvIHNlZSB0aGVpciBkZWZpbml0aW9uLjwvcD4KICAgICAgPHA+QWZ0ZXIgY29tcGxldGluZyB0aGUgZ29hbCwgeW91IG1heSBzZW5kIHlvdXIgc3RvcnkgdG8geW91ciB0ZWFjaGVyIG9yIGNvbnRpbnVlIHdvcmtpbmcgb24gaXQuPC9wPgogICAgPC9kaXY+CiAgICA8aDI+Q29udGludWUgdGhpcyBzdG9yeTo8L2gyPgogICAgPHA+e3tnYW1lLmN1cnJlbnRHYW1lLnByb21wdH19PC9wPgogICAgPGRpdiBjbGFzcz0id2VsbCBzdG9yeSI+CiAgICAgIDxwIGNsYXNzPSJzdG9yeSI+CiAgICAgICAgPHNwYW4gbmctcmVwZWF0PSdzZW50ZW5jZSBpbiBnYW1lLmN1cnJlbnRHYW1lLnNlbnRlbmNlcycgbmctYmluZC1odG1sPSJzZW50ZW5jZS5lbnRyeSI+CiAgICAgIDwvcD4KICAgIDwvZGl2PgogICAgPGRpdiBjbGFzcz0id2VsbCI+CiAgICAgIDxkaXYgY2xhc3M9ImJvdHRvbS1wYW5lbCI+CiAgICAgICAgPGRpdiBjbGFzcz0icm93Ij4KICAgICAgICAgIDx0ZXh0YXJlYSB0eXBlPSJ0ZXh0IiBjbGFzcz0iZm9ybS1jb250cm9sIiBuZy1tb2RlbD0iZ2FtZS5jdXJyZW50R2FtZS5uZXdTZW50ZW5jZSIKICAgICAgICAgICAgbmctZGlzYWJsZWQ9ImdhbWUuZGlzYWJsZVRleHRBcmVhKCkiCiAgICAgICAgICAgIHBsYWNlaG9sZGVyPSJ7e2dhbWUuY3VycmVudEdhbWUudGV4dEFyZWFQbGFjZUhvbGRlcn19Ij4KICAgICAgICAgICAgPC90ZXh0YXJlYT4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkgc2VuZCIgbmctY2xpY2s9ImdhbWUuc3VibWl0RW50cnkoKSI+U2VuZCBTZW50ZW5jZTwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIG5nLWNsaWNrPSJnYW1lLmZpbmlzaCgpIiBuZy1zaG93PSJnYW1lLmlzUmVhZHlUb1N1Ym1pdCgpIgogICAgICAgICAgICA+U3VibWl0IFN0b3J5IHRvIFRlYWNoZXI8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgICAgPHAgbmctc2hvdz0iZ2FtZS5oYXNGaW5pc2hNZXNzYWdlVG9TaG93KCkiPnt7Z2FtZS5jdXJyZW50R2FtZS5maW5pc2hNZXNzYWdlVG9TaG93fX08L3A+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9kaXY+CiAgPC9kaXY+CiAgPGRpdiBjbGFzcz0iY29sLW1kLTIiPjwvZGl2Pgo8L2Rpdj4K","base64"),controller:"GameCtrl as game"}}})
}).controller("GameCtrl",function($scope,$state,Game,User,ProfanityFilter,Punctuation,Partner,uuid4,Link){function generatePartnerUID(){var puid=Partner.getPartnerUID();return puid||(puid=uuid4.generate(),Partner.setPartnerUID(puid)),puid}var game=this,currentUser=User.currentUser;if($state.params.uid&&$state.params.sid&&$state.params.activityPrompt&&User.setCurrentUser({uid:$state.params.uid,sid:$state.params.sid,activityPrompt:$state.params.activityPrompt}),!currentUser){if(currentUser=User.getUserFromLocalStorage(),!currentUser)return console.log("There is no current user. Redirecting to sf.home"),void $state.go("sf.home");User.setCurrentUser(currentUser)}game.currentGame=Game.getGameByUser(User,$scope),Partner.IAmPartner()?game.currentGame.partnerDivShow=!1:(Link.generateAndShortenPartnerURL({partnerUID:generatePartnerUID(),sid:$state.params.sid,activityPrompt:$state.params.activityPrompt}).then(function(shortcode){var url=window.location.origin+"/#/"+shortcode;game.currentGame.partnerURL=url}),game.currentGame.partnerDivShow=!0),game.currentGame.defaultTextAreaPlaceHolder="Type your sentence here. Move your mouse pointer over the story word to see the definition.",game.currentGame.loadingTextAreaPlaceHolder="Waiting for your partner to connect. Please share the link above.",game.currentGame.textAreaPlaceHolder=game.currentGame.loadingTextAreaPlaceHolder,game.getPartnerURL=function(){return game.currentGame.partnerURL},game.fallback=function(copy){window.prompt("Press cmd+c(Mac) or ctrl-c(Windows) to copy the text below.",copy)},game.closePartnerURLDiv=function(){game.currentGame.partnerDivShow=!1},game.currentGame.instructionDivShow=!0,game.closeInstructionDiv=function(){game.currentGame.instructionDivShow=!1};var gameId=User.currentUser.sid;game.currentGame.newSentence="",game.currentGame.finishMessageToShow="",game.closeGame=function(){var gameId=game.currentGame.$id;Game.closeGame(gameId)},game.getCurrentSentence=function(){return game.currentGame.newSentence},game.submitEntry=function(){var sentence=game.getCurrentSentence();if(""!==sentence){var errors=game.validateSentence(sentence);0===errors.length?(Game.sendSentence(gameId,game.currentGame,sentence,User.currentUser),Game.logWords(gameId,game.currentGame,sentence),Game.takeTurns(gameId),game.currentGame.newSentence=""):game.showErrors(errors)}},game.validateSentence=function(sentence){var errors=[],profane=ProfanityFilter.checkSentence(sentence);profane&&errors.push(profane);var incorrectPunctuation=Punctuation.checkEndingPunctuation(sentence);return incorrectPunctuation&&errors.push(incorrectPunctuation),errors},game.showErrors=function(errors){var eString=[];errors.forEach(function(err){err.forEach(function(errString){eString.push(errString)})}),alert(eString.join("\n"))},game.isLocalPlayersTurn=function(){var users=game.currentGame.users;if(users){var userInControl;return angular.forEach(users,function(user){user.isTheirTurn&&(userInControl=user)}),userInControl?userInControl.name===User.localUser:!1}return!1},game.isWordUsed=function(word){var wordUsed=!1;return angular.forEach(game.currentGame.wordsUsed,function(usedWord){word===usedWord.$value&&(wordUsed=!0)}),wordUsed},game.finish=function(){Game.imDone(gameId,game.currentGame,User.currentUser)},game.isReadyToSubmit=function(){return game.currentGame.requirements?game.currentGame.wordsUsed.length>=game.currentGame.requirements.needed:!1},game.hasFinishMessageToShow=function(){return""!==game.currentGame.finishMessageToShow},game.isYou=function(user){return user.name===User.localUser},game.bothPlayersReady=!1,Game.onBothPlayersReady(gameId,function(){game.bothPlayersReady=!0,game.currentGame.textAreaPlaceHolder=game.currentGame.defaultTextAreaPlaceHolder}),game.disableTextArea=function(){return!game.isLocalPlayersTurn()}}),module.exports="sf.game"}).call(this,require("buffer").Buffer)},{"./../../common/services/game/":21,"./../../common/services/profanity-filter/":26,"./../../common/services/punctuation/":27,buffer:1}],8:[function(require,module){(function(Buffer){require("./../../common/services/user/");angular.module("sf.home",["ui.router"]).config(function($stateProvider){$stateProvider.state("sf.home",{url:"/{shortcode:[a-z]{0,3}}?uid&sid&activityPrompt",views:{"content@":{template:Buffer("PGRpdiBjbGFzcz0ianVtYm90cm9uIj4KICA8aDE+V2VsY29tZSB0byBRdWlsbCBXcml0ZXI8L2gxPgogIDxwPlF1aWxsIFdyaXRlciBpcyBhIGNvb3BlcmF0aXZlIHdyaXRpbmcgZ2FtZS4gVHdvIHN0dWRlbnRzIHdpbGwgd3JpdGUKICBhIHBhc3NhZ2UgIHRvZ2V0aGVyIHVzaW5nIGEgc2hhcmVkIGxpc3Qgb2Ygc3Rvcnkgd29yZHMuPC9wPgoKICA8ZGl2IGNsYXNzPSJyb3cgdGV4dC1jZW50ZXIiPgogICAgPHAgY2xhc3M9Iml0YWxpYyI+VGhlIFF1aWxsIFdyaXRlciB0ZWFtcyBoYXZlIGNyZWF0ZWQgMTAgYWN0aXZpdGllcyBmb3IgbmV3IHVzZXJzLjwvcD4KICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IHNlbmQiIG5nLWNsaWNrPSJob21lLnRyeVNhbXBsZUFjdGl2aXR5KCkiPlRyeSBhIFNhbXBsZSBBY3Rpdml0eTwvYnV0dG9uPgogIDwvZGl2PgoKICA8YnIvPgogIDxici8+CgogIDxkaXYgY2xhc3M9InJvdyB0ZXh0LWNlbnRlciI+CiAgICA8cCBjbGFzcz0iaXRhbGljIj5UZWFjaGVycywgY3JlYXRlIHlvdXIgb3duIGFjdGl2aXRpZXMgYW5kIHRoZW4gc2hhcmUgdGhlIGxpbmtzIHdpdGggeW91ciBzdHVkZW50czwvcD4KICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IHNlbmQiIG5nLWNsaWNrPSJob21lLmNyZWF0ZU5ld0FjdGl2aXR5KCkiPkNyZWF0ZSBhIE5ldyBBY3Rpdml0eTwvYnV0dG9uPgogIDwvZGl2PgoKCgo8L2Rpdj4KCg==","base64"),controller:"HomeCtrl as home"}}})}).controller("HomeCtrl",function($state,User,Link,Partner){var home=this;if(home.setUser=function(user){User.setCurrentUser(user),$state.go("sf.game")},home.trySampleActivity=function(){$state.go("sf.sample")},home.createNewActivity=function(){$state.go("sf.form")},"undefined"!=typeof $state.params.shortcode){var shortcode=$state.params.shortcode;Link.mapShortcode(shortcode).then(function(params){Partner.setIAmPartner(!0),$state.go("sf.game",{sid:params.sid,uid:params.partnerUID,activityPrompt:params.activityPrompt}),Link.removeShortCodeMapping(shortcode)},function(){console.log("shortcode not found")})}}),module.exports="sf.home"}).call(this,require("buffer").Buffer)},{"./../../common/services/user/":28,buffer:1}],9:[function(require,module){(function(Buffer){require("./../../common/services/user/"),require("./../../common/services/empirical/");angular.module("sf.link",["ui.router"]).config(function($stateProvider){$stateProvider.state("sf.link",{url:"/link?id&name&userName",views:{"content@":{template:Buffer("PGRpdiBjbGFzcz0ianVtYm90cm9uIj4KICA8aDE+V2VsY29tZSB0byBRdWlsbCBXcml0ZXI8L2gxPgogIDxwPlF1aWxsIFdyaXRlciBpcyBhIGNvb3BlcmF0aXZlIHdyaXRpbmcgZ2FtZS4gVHdvIHN0dWRlbnRzIHdpbGwgd3JpdGUKICBhIHBhc3NhZ2UgIHRvZ2V0aGVyIHVzaW5nIGEgc2hhcmVkIGxpc3Qgb2Ygc3Rvcnkgd29yZHMuPC9wPgoKICA8ZGl2IGNsYXNzPSJyb3cgdGlnaHQiPgogICAgPGRpdiBjbGFzcz0icm93Ij4KICAgICAgPGgyPllvdXIgUHJvbXB0PC9oMj4KICAgICAgPGgzPnt7bGluay5wcm9tcHQubmFtZX19PC9oMz4KICAgICAgPHAgY2xhc3M9Iml0YWxpYyI+e3tsaW5rLnByb21wdC5wcm9tcHR9fQogICAgICBVc2luZyB0aGUgZm9sbG93aW5nIHdvcmRzCiAgICAgIHt7bGluay53b3JkTGlzdH19CiAgICAgIDwvcD4KICAgIDwvZGl2PgogICAgPGRpdiBjbGFzcz0icm93Ij4KICAgICAgPGgyPllvdXIgUGFydG5lcnMgTGluazwvaDI+CiAgICAgIDxhIGhyZWY9Int7bGluay5wYXJ0bmVyTGlua319Ij57e2xpbmsucGFydG5lckxpbmt9fTwvYT4KICAgICAgPHAgY2xhc3M9Iml0YWxpYyI+U2VuZCB0aGlzIGxpbmsgdG8geW91ciBwYXJ0bmVyIHNvIHRoYXQgeW91CiAgICAgIGFuZCB5b3VyIHBhcnRuZXIgY2FuIGpvaW4gdGhlIHNhbWUgZ2FtZS4gT25lIHBlcnNvbiBzaG91bGQgc2hhcmUKICAgICAgdGhlIGxpbmssIGFuZCB0aGUgb3RoZXIgcGVyc29uIHNob3VsZCBwcmVzcyB0aGUgc3RhcnQgZ2FtZSBidXR0b24uCiAgICAgIDwvcD4KICAgIDwvZGl2PgogICAgPGRpdiBjbGFzcz0icm93Ij4KICAgICAgPGgyPlN0YXJ0IEdhbWU8L2gyPgogICAgICA8cCBjbGFzcz0iaXRhbGljIj5PbmNlIHlvdSBoYXZlIHNoYXJlZCB0aGUgbGluayBwcmVzcyB0aGUgc3RhcnQgZ2FtZSBidXR0b24uCiAgICAgIDwvcD4KICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkgc2VuZCIgbmctY2xpY2s9ImxpbmsubmV4dCgpIj5TdGFydCBHYW1lPC9idXR0b24+CiAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY+Cgo=","base64"),controller:"LinkCtrl as link"}}})}).controller("LinkCtrl",function($state,User,Empirical,_,uuid4,Partner){var link=this,id=$state.params.id,name=$state.params.name,sid=($state.params.userName,uuid4.generate());Empirical.getAvailablePrompts().$loaded().then(function(prompts){prompts=_.each(prompts,function(p){p.$id===id&&(link.prompt=p,link.prompt.name||(link.prompt.name=name),"string"==typeof link.prompt.wordList&&(link.prompt.wordList=JSON.parse(link.prompt.wordList)),link.wordList="",_.each(link.prompt.wordList,function(w){link.wordList=""!==link.wordList?link.wordList+", "+w.word:link.wordList+w.word}),link.wordList=link.wordList+".")})}),link.next=function(){var uid=uuid4.generate();link.stateChange(uid,sid,id)},link.stateChange=function(uid,sid,activityUID){$state.go("sf.game",{uid:uid,sid:sid,activityPrompt:activityUID})},link.generatePartnerLink=function(sid,activityUID){var uid=uuid4.generate();return Partner.setPartnerUID(uid),"https://quill-writer.firebaseapp.com/#/games?uid="+uid+"&sid="+sid+"&activityPrompt="+activityUID},link.partnerLink=link.generatePartnerLink(sid,id),Partner.setPartnerURL(link.partnerLink),link.next()}),module.exports="sf.link"}).call(this,require("buffer").Buffer)},{"./../../common/services/empirical/":18,"./../../common/services/user/":28,buffer:1}],10:[function(require,module){(function(Buffer){{var moduleName="sf.lobby",home=require("./../home");require("./../../common/services/lobby/")}angular.module(moduleName,["ui.router"]).config(function($stateProvider){$stateProvider.state(moduleName,{url:"/lobby?id&name&userName",views:{"content@":{template:Buffer("PGgyPkxvYmJ5IHt7bG9iYnkubmFtZX19PC9oMj4KCjxoMz5Mb2JieSBNZW1iZXJzPC9oMz4KCjx1bD4KICA8bGkgbmctcmVwZWF0PSdtZW1iZXIgaW4gbG9iYnkucm9vbS5tZW1iZXJzJz57e21lbWJlcn19PC9saT4KPC91bD4KCjxmb3JtIG5nLXN1Ym1pdD0ibG9iYnkuYWRkU3R1ZGVudFRvUm9vbSgpIj4KICA8bGFiZWwgZm9yPSJzdHVkZW50TmFtZSI+WW91ciBuYW1lPC9sYWJlbD4KICA8aW5wdXQgbmctbW9kZWw9ImxvYmJ5LmxvY2FsU3R1ZGVudC5uYW1lIiB0eXBlPSJ0ZXh0IiBpZD0ic3R1ZGVudE5hbWUiPjwvaW5wdXQ+CiAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXByaW1hcnkgc2VuZCIgbmctY2xpY2s9ImxvYmJ5LmFkZFN0dWRlbnRUb1Jvb20oKSIKICAgIG5nLWRpc2FibGVkPSJsb2JieS5sb2NhbFN0dWRlbnQuYWRkZWQiCiAgICA+Sm9pbiBMb2JieSB7e2xvYmJ5Lm5hbWV9fTwvYnV0dG9uPgogIDxwPnt7bG9iYnkubWVzc2FnZX19PC9wPgo8L2Zvcm0+Cgo=","base64"),controller:"LobbyCtrl as lobby"}}})}).controller("LobbyCtrl",function($state,$scope,Lobby,uuid4){var lobby=this,lobbyId=$state.params.id,lobbyName=$state.params.name;return lobbyId?(lobby.id=lobbyId,lobby.name=lobbyName,lobby.room=Lobby.connectToLobby($scope,lobbyId),lobby.localStudent={},lobby.addStudentToRoom=function(){lobby.localStudent.uuid=uuid4.generate(),Lobby.addStudentToRoom(lobby.localStudent,lobbyId),lobby.localStudent.added=!0},$state.params.userName&&(lobby.localStudent.name=$state.params.userName,lobby.addStudentToRoom(),lobby.message="Thanks "+lobby.localStudent.name+". You will be joined by your partner soon."),lobby):void $state.go(home)}),module.exports=moduleName}).call(this,require("buffer").Buffer)},{"./../../common/services/lobby/":24,"./../home":8,buffer:1}],11:[function(require,module){(function(Buffer){require("./../../common/services/user/"),require("./../../common/services/empirical/");angular.module("sf.myactivity",["ui.router"]).config(function($stateProvider){$stateProvider.state("sf.myactivity",{url:"/myactivity/:id",views:{"content@":{template:Buffer("PGRpdiBjbGFzcz0ianVtYm90cm9uIj4KICA8aDE+V2VsY29tZSB0byBRdWlsbCBXcml0ZXI8L2gxPgogIDxwPlF1aWxsIFdyaXRlciBpcyBhIGNvb3BlcmF0aXZlIHdyaXRpbmcgZ2FtZS4gVHdvIHN0dWRlbnRzIHdpbGwgd3JpdGUKICBhIHBhc3NhZ2UgIHRvZ2V0aGVyIHVzaW5nIGEgc2hhcmVkIGxpc3Qgb2Ygc3Rvcnkgd29yZHMuPC9wPgoKICA8ZGl2IGNsYXNzPSJyb3cgdGV4dC1jZW50ZXIiPgogICAgPGgyPnt7bXlhY3Rpdml0eS5hY3Rpdml0eS5uYW1lfX08L2gyPgogICAgPHA+e3tteWFjdGl2aXR5LmFjdGl2aXR5LnByb21wdH19PC9wPgogICAgPGJyLz4KICAgIDxpbnB1dCBwbGFjZWhvbGRlcj0iWW91ciBuYW1lIiBuZy1tb2RlbD0ibXlhY3Rpdml0eS51c2VyTmFtZSIgdHlwZT10ZXh0Ij48L2lucHV0PgogICAgPGJyLz4KICAgIDxici8+CiAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSBzZW5kIiBuZy1jbGljaz0ibXlhY3Rpdml0eS5uZXh0KG15YWN0aXZpdHkudXNlck5hbWUpIj5OZXh0PC9idXR0b24+CiAgICA8YnIvPgogIDwvZGl2PgoKCgo8L2Rpdj4KCg==","base64"),controller:"MyactivityCtrl as myactivity"}}})}).controller("MyactivityCtrl",function($state,User,Empirical){var myactivity=this,id=$state.params.id,activity=Empirical.getActivity(id);activity.$loaded().then(function(a){myactivity.activity=a}),myactivity.next=function(un){$state.go("sf.link",{id:id,name:myactivity.activity.name,userName:un})}}),module.exports="sf.myactivity"}).call(this,require("buffer").Buffer)},{"./../../common/services/empirical/":18,"./../../common/services/user/":28,buffer:1}],12:[function(require,module){(function(Buffer){require("./../../common/services/user/"),require("./../../common/services/empirical/");angular.module("sf.sample",["ui.router"]).config(function($stateProvider){$stateProvider.state("sf.sample",{url:"/sample",views:{"content@":{template:Buffer("PGRpdiBjbGFzcz0ianVtYm90cm9uIj4KICA8aDE+V2VsY29tZSB0byBRdWlsbCBXcml0ZXI8L2gxPgogIDxwPlF1aWxsIFdyaXRlciBpcyBhIGNvb3BlcmF0aXZlIHdyaXRpbmcgZ2FtZS4gVHdvIHN0dWRlbnRzIHdpbGwgd3JpdGUKICBhIHBhc3NhZ2UgIHRvZ2V0aGVyIHVzaW5nIGEgc2hhcmVkIGxpc3Qgb2Ygc3Rvcnkgd29yZHMuPC9wPgoKICA8ZGl2IGNsYXNzPSJyb3cgdGV4dC1jZW50ZXIiPgogICAgPHA+U2VsZWN0IGEgc2FtcGxlIGFjdGl2aXR5PC9wPgogICAgPHNlbGVjdCBuZy1tb2RlbD0ic2FtcGxlLnRoZVByb21wdCIgbmctb3B0aW9ucz0icHJvbXB0Lm5hbWUgZm9yIHByb21wdCBpbiBzYW1wbGUuYXZhaWxhYmxlUHJvbXB0cyI+PC9zZWxlY3Q+CiAgICA8YnIvPgogICAgPGJyLz4KICAgIDxpbnB1dCBwbGFjZWhvbGRlcj0iWW91ciBuYW1lIiBuZy1tb2RlbD0ic2FtcGxlLnVzZXJOYW1lIiB0eXBlPXRleHQiPjwvaW5wdXQ+CiAgICA8YnIvPgogICAgPGJyLz4KICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IHNlbmQiIG5nLWNsaWNrPSJzYW1wbGUubmV4dChzYW1wbGUudGhlUHJvbXB0LCBzYW1wbGUudXNlck5hbWUpIj5OZXh0PC9idXR0b24+CiAgICA8YnIvPgogICAgPHAgY2xhc3M9Iml0YWxpYyI+SWYgeW91ciB0ZWFjaGVyIGhhcyBjcmVhdGVkIGFuIGFjdGl2aXR5LCBhc2sgeW91ciB0ZWFjaGVyIHRvIHNoYXJlIHRoZSBsaW5rLjwvcD4KICA8L2Rpdj4KCgoKPC9kaXY+Cgo=","base64"),controller:"SampleCtrl as sample"}}})}).controller("SampleCtrl",function($state,User,Empirical,_){var sample=this;Empirical.getAvailablePrompts().$loaded().then(function(prompts){prompts=_.each(prompts,function(p){p.id=p.$id}),prompts=_.filter(prompts,function(p){return!p.private}),sample.availablePrompts=prompts}),sample.next=function(p,un){$state.go("sf.link",{id:p.id,name:p.name,userName:un})}}),module.exports="sf.sample"}).call(this,require("buffer").Buffer)},{"./../../common/services/empirical/":18,"./../../common/services/user/":28,buffer:1}],13:[function(require,module){(function(Buffer){var sfConstants=require("./../../constants");angular.module("sf.components.footer",[sfConstants]).directive("sfFooter",function(){return{restrict:"E",template:Buffer("","base64"),controller:"SfFooterCtrl as footer"}}).controller("SfFooterCtrl",function(appName){var footer=this;footer.appName=appName}),module.exports="sf.components.footer"}).call(this,require("buffer").Buffer)},{"./../../constants":16,buffer:1}],14:[function(require,module){(function(Buffer){var sfConstants=require("./../../constants");angular.module("sf.components.header",[sfConstants]).directive("sfHeader",function(){return{restrict:"E",template:Buffer("PGJyPgo8bmF2IGNsYXNzPSJuYXZiYXIgbmF2YmFyLWRlZmF1bHQiIHJvbGU9Im5hdmlnYXRpb24iPgogIDxkaXYgY2xhc3M9ImNvbnRhaW5lci1mbHVpZCI+CiAgICA8IS0tIEJyYW5kIGFuZCB0b2dnbGUgZ2V0IGdyb3VwZWQgZm9yIGJldHRlciBtb2JpbGUgZGlzcGxheSAtLT4KICAgIDxkaXYgY2xhc3M9Im5hdmJhci1oZWFkZXIiPgogICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9Im5hdmJhci10b2dnbGUiIGRhdGEtdG9nZ2xlPSJjb2xsYXBzZSIgZGF0YS10YXJnZXQ9IiNicy1leGFtcGxlLW5hdmJhci1jb2xsYXBzZS0xIj4KICAgICAgICA8c3BhbiBjbGFzcz0ic3Itb25seSI+VG9nZ2xlIG5hdmlnYXRpb248L3NwYW4+CiAgICAgICAgPHNwYW4gY2xhc3M9Imljb24tYmFyIj48L3NwYW4+CiAgICAgICAgPHNwYW4gY2xhc3M9Imljb24tYmFyIj48L3NwYW4+CiAgICAgICAgPHNwYW4gY2xhc3M9Imljb24tYmFyIj48L3NwYW4+CiAgICAgIDwvYnV0dG9uPgogICAgICA8YSBjbGFzcz0ibmF2YmFyLWJyYW5kIHRpdGxlIiBocmVmIHVpLXNyZWY9J3NmLmhvbWUnPnt7aGVhZGVyLmFwcE5hbWV9fTwvYT4KICAgIDwvZGl2PgogIDwvZGl2PjwhLS0gLy5jb250YWluZXItZmx1aWQgLS0+CjwvbmF2Pgo=","base64"),controller:"SfHeaderCtrl as header"}}).controller("SfHeaderCtrl",function(appName,tagLine){var header=this;header.appName=appName,header.tagLine=tagLine}),module.exports="sf.components.header"}).call(this,require("buffer").Buffer)},{"./../../constants":16,buffer:1}],15:[function(require,module){var sfHeader=require("./header/"),sfFooter=require("./footer/");angular.module("sf.common.components",[sfHeader,sfFooter]),module.exports="sf.common.components"},{"./footer/":13,"./header/":14}],16:[function(require,module){angular.module("sf.constants",[]).constant("appName","Quill Writer").constant("tagLine","Learn by Writing Together").constant("baseFbUrl","https://quill-writer.firebaseio.com/").constant("empiricalBaseURL","https://staging.quill.org/api/v1"),module.exports="sf.constants"},{}],17:[function(require,module){var sfComponents=require("./components/"),sfServices=require("./services/");angular.module("sf.common",[sfComponents,sfServices]),module.exports="sf.common"},{"./components/":15,"./services/":22}],18:[function(require,module){var sfConstants=require("./../../constants"),moduleName="sf.services.empirical",serviceName="Empirical";angular.module(moduleName,[sfConstants]).service(serviceName,function($http,$q,$firebase,baseFbUrl,empiricalBaseURL,_){var empirical=this,staticUIDs=require("./stories.uids.json"),currentActivity=null;empirical.getUserInformation=function(){},empirical.getCurrentActivityData=function(){return currentActivity},empirical.getWordList=function(activityId,cb){var wl=empirical.getCurrentActivityData().wordList;"string"==typeof wl&&(wl=JSON.parse(wl)),cb(wl)},empirical.getStoryRequirements=function(activityId,cb){empirical.getWordList(activityId,function(wordList){var wordsLength=wordList.length;cb({needed:6>wordsLength?wordsLength:6})})},empirical.getPrompt=function(activityId,cb){cb(empirical.getCurrentActivityData().prompt)},empirical.flagSentence=function(){},empirical.submitStory=function(){},empirical.mapUIDs=function(tryThisId){return staticUIDs[tryThisId]?staticUIDs[tryThisId]:tryThisId},empirical.initializeGame=function(game,users,currentUser){var sessionId=currentUser.activityPrompt,activityUID=empirical.mapUIDs(sessionId);empirical.loadActivity(activityUID).then(function(){empirical.getPrompt(sessionId,function(p){game.prompt=p}),empirical.getWordList(sessionId,function(wordList){game.wordList=wordList}),empirical.getStoryRequirements(sessionId,function(requirements){game.requirements=requirements})},function(err){alert(err)})};var activitiesRef=new Firebase(baseFbUrl+"/activities");empirical.getActivity=function(activityUID){return $firebase(activitiesRef.child(activityUID)).$asObject()},empirical.loadActivity=function(activityUID){var activityPromise=$q.defer(),activity=empirical.getActivity(activityUID);return activity.$loaded().then(function(a){a.prompt?(currentActivity=a,activityPromise.resolve()):activityPromise.reject(new Error("Activity UID "+activityUID+" didn't exist"))}),activityPromise.promise},empirical.createActivity=function(activity,cb){console.log("submitting this activity %s",JSON.stringify(activity)),cb()},empirical.getRandomPromptUID=function(){return staticUIDs[_.random(1,_.size(staticUIDs))]},empirical.getAvailablePrompts=function(){return $firebase(activitiesRef).$asArray()}}),module.exports=moduleName},{"./../../constants":16,"./stories.uids.json":19}],19:[function(require,module){module.exports={6:"Terc8QSZ-JuRajc28mbYDQ",4:"mpqaFWtVG-GhYhgv6yln8Q",1:"7_fLLcFTx2U9rUFKeoTKwA",3:"5cC4B0UaZ1qnRFkIaDFdsQ",2:"MhCTCOCLWfVsXIQ4LzARkw",5:"yDQh3Nq0vE3C-WwslCmb9Q"}},{}],20:[function(require,module){var sfConstants=require("./../../constants");angular.module("sf.services.form",[sfConstants]).service("Form",function(baseFbUrl,$firebase){var form=this,activitesRef=new Firebase(baseFbUrl+"/activities");form.submit=function(f,cb){f.private=!0;var activities=$firebase(activitesRef).$asArray();activities.$add(f).then(function(ref){console.log(ref.name()),cb(null,ref.name())})}}),module.exports="sf.services.form"},{"./../../constants":16}],21:[function(require,module){var sfConstants=require("../../constants"),sfEmpirical=require("../empirical");angular.module("sf.services.game",[sfConstants,sfEmpirical]).service("Game",function($firebase,baseFbUrl,Empirical,_,$analytics){var gameModel=this,gamesRef=new Firebase(baseFbUrl+"/games");gameModel.get=function(id){return $firebase(gameModel.getRef(id))},gameModel.getRef=function(id){return gamesRef.child(id)},gameModel.getGameByUser=function(User,$scope){function makeNewUser(length){currentUser.name="Player "+String(length+1),currentUser.done=!1,currentUser.isTheirTurn="Player 1"===currentUser.name,currentUser.leader="Player 1"===currentUser.name,User.localUser=currentUser.name,gameUsers.$add(currentUser).then(function(newUserRef){gameUsers.$loaded(function(){var userFinishMessageToShow=$firebase(newUserRef.child("finishMessageToShow")).$asObject();userFinishMessageToShow.message="",userFinishMessageToShow.$watch(function(){$scope.finishMessageToShow=userFinishMessageToShow.message}),userFinishMessageToShow.$save().then(function(){var newUser=gameUsers.$getRecord(newUserRef.name());newUser.finishMessageToShow=userFinishMessageToShow,gameUsers.$save(newUser),User.setCurrentUser(newUser)})})}),User.setCurrentUser(currentUser)}function findCurrentUser(){var localUser=currentUser,returnUser=null,index=0;return _.each(gameUsers,function(gameUser){console.log(gameModel.isSameUser(gameUser,localUser)),gameModel.isSameUser(gameUser,localUser)&&(returnUser=index),index++}),console.log(gameUsers),console.log(returnUser),gameUsers[returnUser]}var currentUser=User.currentUser,gameRef=gameModel.getRef(currentUser.sid),gameUsersRef=gameRef.child("users"),gameUsers=$firebase(gameUsersRef).$asArray();gameUsers.$loaded(function(){var length=gameUsers.length,gameUser=findCurrentUser();console.log(gameUser),gameUser?(currentUser=gameUser,User.localUser=currentUser.name):2>length&&makeNewUser(length),Empirical.initializeGame($scope,gameUsers,currentUser)}).then(function(){$scope.users=gameUsers});var wordsUsed=$firebase(gameRef.child("wordsUsed")).$asArray(),sentences=$firebase(gameRef.child("sentences")).$asArray(),wordsUsedLength=$firebase(gameRef.child("wordsUsedLength")).$asObject();return wordsUsedLength.$loaded(function(){wordsUsedLength.length||(wordsUsedLength.length=0,wordsUsedLength.$save())}),wordsUsed.$watch(function(){wordsUsedLength.$loaded(function(){wordsUsedLength.length=wordsUsed.length,wordsUsedLength.$save()})}),$scope.wordsUsedLength=wordsUsedLength,$scope.wordsUsed=wordsUsed,$scope.sentences=sentences,$scope},gameModel.getSentences=function(gameId){return $firebase(gameModel.getRef(gameId).child("sentences")).$asArray()},gameModel.closeGame=function(gameId,currentUser){console.log(currentUser),currentUser.leader&&$analytics.eventTrack("Quill-Writer Submit Story to Teacher"),console.log("Close game %s",gameId)},gameModel.sendSentence=function(gameId,currentGame,sentence,currentUser){sentence=gameModel.highlightWords(gameId,currentGame,sentence),sentence=gameModel.appendExtraSpaceIfNeccessary(sentence),gameModel.getSentences(gameId).$add({entry:sentence,user:currentUser})},gameModel.appendExtraSpaceIfNeccessary=function(sentence){var tokens=sentence.split("");return" "!==tokens[tokens.length-1]&&tokens.push(" "),tokens.join("")},gameModel.highlightWords=function(gameId,currentGame,sentence){var wordsToUse=currentGame.wordList,wordsInSentence=sentence.split(" "),returnedSentences=[];return wordsInSentence.forEach(function(cased_word){for(var word=cased_word.toLowerCase(),i=0;i<wordsToUse.length;i++){var wordToLookAt=wordsToUse[i].word.toLowerCase();(word===wordToLookAt||-1!==word.indexOf(wordToLookAt))&&(cased_word="<b>"+cased_word+"</b>")}returnedSentences.push(cased_word)}),returnedSentences.join(" ")},gameModel.takeTurns=function(gameId){var game=gameModel.getRef(gameId),users=$firebase(game.child("users")).$asArray();users.$loaded().then(function(){angular.forEach(users,function(user){user.isTheirTurn=!user.isTheirTurn,users.$save(user)})})},gameModel.isSameUser=function(u1,u2){return u1.sid===u2.sid&&u1.uid===u2.uid},gameModel.imDone=function(gameId,currentGame,currentUser){var game=gameModel.getRef(gameId),users=$firebase(game.child("users")).$asArray();users.$loaded().then(function(){angular.forEach(users,function(user){gameModel.isSameUser(user,currentUser)?(user.done=!0,user.finishMessageToShow.message="You have submitted the story. Waiting for the other player to approve."):user.finishMessageToShow.message="The other player has voted to submit to the story. Press submit to teacher when you feel the story is complete. You may continue to use words.",users.$save(user).then(function(){users.$loaded().then(function(){var allDone=!0;angular.forEach(users,function(user){allDone&&!user.done&&(allDone=!1)}),allDone&&(angular.forEach(users,function(user){user.finishMessageToShow.message="You have completed this story!",users.$save(user)}),gameModel.closeGame(gameId,currentUser))})})})})},gameModel.onBothPlayersReady=function(gameId,cb){var game=gameModel.getRef(gameId),users=$firebase(game.child("users")).$asArray();users.$loaded().then(function(){if(users.length>=2)cb();else var unwatch=users.$watch(function(){users.length>=2&&(cb(),unwatch())})})},gameModel.logWords=function(gameId,currentGame,sentence){var gameRef=gameModel.getRef(gameId),wordsUsed=$firebase(gameRef.child("wordsUsed")).$asArray(),wordsToUse=currentGame.wordList,wordsInSentence=sentence.split(" "),wordsToAdd=[];wordsInSentence.forEach(function(cased_word){for(var word=cased_word.toLowerCase(),i=0;i<wordsToUse.length;i++){var wordToLookAt=wordsToUse[i].word.toLowerCase();(word===wordToLookAt||-1!==word.indexOf(wordToLookAt))&&wordsToAdd.push(wordsToUse[i].word)}}),wordsUsed.$loaded(function(){var uniqueWordsToAdd=_.uniq(wordsToAdd);0===wordsUsed.length&&uniqueWordsToAdd.length>0&&$analytics.eventTrack("Quill-Writer Story Word Used",{wordUsed:uniqueWordsToAdd[0]}),_.each(uniqueWordsToAdd,function(word){wordsUsed.$add(word)})})}}),module.exports="sf.services.game"},{"../../constants":16,"../empirical":18}],22:[function(require,module){var User=require("./user/"),Game=require("./game/"),Form=require("./form/"),Lobby=require("./lobby/"),Empirical=require("./empirical/"),Partner=require("./partner/"),ProfanityFilter=require("./profanity-filter/"),Punctuation=require("./punctuation/"),Link=require("./link/");angular.module("sf.common.services",[User,Game,Form,Lobby,Empirical,ProfanityFilter,Punctuation,Partner,Link]),module.exports="sf.common.services"},{"./empirical/":18,"./form/":20,"./game/":21,"./link/":23,"./lobby/":24,"./partner/":25,"./profanity-filter/":26,"./punctuation/":27,"./user/":28}],23:[function(require,module){var moduleName="sf.services.link";angular.module(moduleName,[]).service("Link",function($q,$firebase,baseFbUrl){function genId(len,charSet){charSet=charSet||"abcdefghijklmnopqrstuvwxyz";for(var randomString="",i=0;len>i;i++){var randomPoz=Math.floor(Math.random()*charSet.length);randomString+=charSet.substring(randomPoz,randomPoz+1)}return randomString}function genIdAndCheck(len,links){for(var potentialId=genId(len);"undefined"!=typeof links[potentialId];)potentialId=genId(len);return potentialId}var link=this,ref=new Firebase(baseFbUrl+"/shortLinks");link.generateAndShortenPartnerURL=function(params){var deferred=$q.defer(),links=$firebase(ref).$asObject();return links.$loaded().then(function(){var potentialId=genIdAndCheck(3,links);links[potentialId]=params,links.$save().then(function(){deferred.resolve(potentialId)})}),deferred.promise},link.mapShortcode=function(shortcode){var deferred=$q.defer(),links=$firebase(ref).$asObject();return links.$loaded().then(function(){"undefined"!=typeof links[shortcode]?deferred.resolve(links[shortcode]):deferred.reject()}),deferred.promise},link.removeShortCodeMapping=function(shortcode){var links=$firebase(ref).$asObject();links.$loaded().then(function(){links[shortcode]&&(delete links[shortcode],links.$save())})}}),module.exports=moduleName},{}],24:[function(require,module){var moduleName="sf.services.lobby",serviceName="Lobby",game=require("./../../../app/game/"),sfConstants=require("../../constants");angular.module(moduleName,[sfConstants]).service(serviceName,function($firebase,baseFbUrl,Empirical,$analytics,_,$state){var lobbyService=this,lobbyRef=new Firebase(baseFbUrl+"/lobby");lobbyService.GROUP_SIZE=2,lobbyService.getRoomRef=function(lobbyId){return lobbyRef.child(String(lobbyId))},lobbyService.getRoom=function(roomRef){return $firebase(roomRef)},lobbyService.getRoomMembers=function(roomRef){var roomMembersRef=roomRef.child("members"),roomMembers=$firebase(roomMembersRef).$asArray();return roomMembers},lobbyService.connectToLobby=function($scope,lobbyId){var roomMembers=lobbyService.getRoomMembers(lobbyService.getRoomRef(lobbyId));return $scope.members=roomMembers,$scope},lobbyService.addStudentToRoom=function(student,lobbyId){var roomMembers=lobbyService.getRoomMembers(lobbyService.getRoomRef(lobbyId));roomMembers.$add(student),lobbyService.addStudentToGroup(student,lobbyId)},lobbyService.getGroupsRef=function(roomRef){return roomRef.child("groups")},lobbyService.getGroups=function(roomRef){return $firebase(lobbyService.getGroupsRef(roomRef)).$asArray()},lobbyService.localGroupWatcher=function(groupId,student,lobbyId){console.log("Registering with the local group watcher with %s %s %s",groupId,student,lobbyId);var groupsRef=lobbyService.getGroupsRef(lobbyService.getRoomRef(lobbyId)),groupRef=groupsRef.child(groupId),group=$firebase(groupRef).$asObject();group.$watch(function(){group.full?lobbyService.startGameFor($firebase(groupsRef),group,student,lobbyId):console.log("Group %s not full yet!",groupId)})},lobbyService.startGameFor=function(groups,group,student,lobbyId){console.log("Starting game for %s %s %s",group.$id,student,lobbyId),$state.go(game,{uid:student.uuid,sid:group.$id,activityPrompt:group.activityPrompt}),student.leader&&(console.log("Student is the leader. Doing leader functions"),groups.$remove(group.$id).then(function(ref){console.log("Leader removed %s",ref.name())}))},lobbyService.addStudentToGroup=function(student,lobbyId){var roomRef=lobbyService.getRoomRef(lobbyId),groups=lobbyService.getGroups(roomRef);groups.$loaded().then(function(list){var slotAvailable=_.findWhere(list,{full:!1});slotAvailable?(slotAvailable.members.push(student),slotAvailable.members.length>=lobbyService.GROUP_SIZE&&(slotAvailable.full=!0),lobbyService.localGroupWatcher(slotAvailable.$id,student,lobbyId),setTimeout(function(){groups.$save(slotAvailable)},200)):(student.leader=!0,groups.$add({members:[student],full:!1,activityPrompt:lobbyId}).then(function(ref){lobbyService.localGroupWatcher(ref.name(),student,lobbyId)}))})}}),module.exports=moduleName},{"../../constants":16,"./../../../app/game/":7}],25:[function(require,module){var sfConstants=require("./../../constants");angular.module("sf.services.partner",[sfConstants]).service("Partner",function(localStorageService){var partner=this,key="PartnerURL",puidKey="PartnerUID",partnerKey="IAMPARTNER";partner.setPartnerURL=function(purl){localStorageService.set(key,purl)},partner.getPartnerURL=function(){return localStorageService.get(key)},partner.setPartnerUID=function(puid){localStorageService.set(puidKey,puid)},partner.getPartnerUID=function(){return localStorageService.get(puidKey)},partner.setIAmPartner=function(val){localStorageService.set(partnerKey,val)},partner.IAmPartner=function(){return localStorageService.get(partnerKey)}}),module.exports="sf.services.partner"},{"./../../constants":16}],26:[function(require,module){angular.module("sf.services.profanity-filter",[]).service("ProfanityFilter",function(){var pFilter=this;pFilter.checkSentence=function(sentence){var wordsInSentence=sentence.split(" "),badWordsInSentence=[];for(var badWord in pFilter.badWords)for(var i=0;i<wordsInSentence.length;i++){var word=wordsInSentence[i].toLowerCase();word===badWord&&badWordsInSentence.push(word)}for(var errors=[],j=0;j<badWordsInSentence.length;j++){var bWord=badWordsInSentence[j];
errors.push('Please do not use "'+bWord+'". It is profane.')}return 0===errors.length?null:errors},pFilter.badWords={"4r5e":1,"5h1t":1,"5hit":1,a55:1,anal:1,anus:1,ar5e:1,arrse:1,arse:1,ass:1,"ass-fucker":1,asses:1,assfucker:1,assfukka:1,asshole:1,assholes:1,asswhole:1,a_s_s:1,"b!tch":1,b00bs:1,b17ch:1,b1tch:1,ballbag:1,balls:1,ballsack:1,bastard:1,beastial:1,beastiality:1,bellend:1,bestial:1,bestiality:1,"bi+ch":1,biatch:1,bitch:1,bitcher:1,bitchers:1,bitches:1,bitchin:1,bitching:1,bloody:1,"blow job":1,blowjob:1,blowjobs:1,boiolas:1,bollock:1,bollok:1,boner:1,boob:1,boobs:1,booobs:1,boooobs:1,booooobs:1,booooooobs:1,breasts:1,buceta:1,bugger:1,bum:1,"bunny fucker":1,butt:1,butthole:1,buttmuch:1,buttplug:1,c0ck:1,c0cksucker:1,"carpet muncher":1,cawk:1,chink:1,cipa:1,cl1t:1,clit:1,clitoris:1,clits:1,cnut:1,cock:1,"cock-sucker":1,cockface:1,cockhead:1,cockmunch:1,cockmuncher:1,cocks:1,"cocksuck ":1,"cocksucked ":1,cocksucker:1,cocksucking:1,"cocksucks ":1,cocksuka:1,cocksukka:1,cok:1,cokmuncher:1,coksucka:1,coon:1,cox:1,crap:1,cum:1,cummer:1,cumming:1,cums:1,cumshot:1,cunilingus:1,cunillingus:1,cunnilingus:1,cunt:1,"cuntlick ":1,"cuntlicker ":1,"cuntlicking ":1,cunts:1,cyalis:1,cyberfuc:1,"cyberfuck ":1,"cyberfucked ":1,cyberfucker:1,cyberfuckers:1,"cyberfucking ":1,d1ck:1,damn:1,dick:1,dickhead:1,dildo:1,dildos:1,dink:1,dinks:1,dirsa:1,dlck:1,"dog-fucker":1,doggin:1,dogging:1,donkeyribber:1,doosh:1,duche:1,dyke:1,ejaculate:1,ejaculated:1,"ejaculates ":1,"ejaculating ":1,ejaculatings:1,ejaculation:1,ejakulate:1,"f u c k":1,"f u c k e r":1,f4nny:1,fag:1,fagging:1,faggitt:1,faggot:1,faggs:1,fagot:1,fagots:1,fags:1,fanny:1,fannyflaps:1,fannyfucker:1,fanyy:1,fatass:1,fcuk:1,fcuker:1,fcuking:1,feck:1,fecker:1,felching:1,fellate:1,fellatio:1,"fingerfuck ":1,"fingerfucked ":1,"fingerfucker ":1,fingerfuckers:1,"fingerfucking ":1,"fingerfucks ":1,fistfuck:1,"fistfucked ":1,"fistfucker ":1,"fistfuckers ":1,"fistfucking ":1,"fistfuckings ":1,"fistfucks ":1,flange:1,fook:1,fooker:1,fuck:1,fucka:1,fucked:1,fucker:1,fuckers:1,fuckhead:1,fuckheads:1,fuckin:1,fucking:1,fuckings:1,fuckingshitmotherfucker:1,"fuckme ":1,fucks:1,fuckwhit:1,fuckwit:1,"fudge packer":1,fudgepacker:1,fuk:1,fuker:1,fukker:1,fukkin:1,fuks:1,fukwhit:1,fukwit:1,fux:1,fux0r:1,f_u_c_k:1,gangbang:1,"gangbanged ":1,"gangbangs ":1,gaylord:1,gaysex:1,goatse:1,God:1,"god-dam":1,"god-damned":1,goddamn:1,goddamned:1,"hardcoresex ":1,hell:1,heshe:1,hoar:1,hoare:1,hoer:1,homo:1,hore:1,horniest:1,horny:1,hotsex:1,"jack-off ":1,jackoff:1,jap:1,"jerk-off ":1,jism:1,"jiz ":1,"jizm ":1,jizz:1,kawk:1,knob:1,knobead:1,knobed:1,knobend:1,knobhead:1,knobjocky:1,knobjokey:1,kock:1,kondum:1,kondums:1,kum:1,kummer:1,kumming:1,kums:1,kunilingus:1,"l3i+ch":1,l3itch:1,labia:1,lmfao:1,lust:1,lusting:1,m0f0:1,m0fo:1,m45terbate:1,ma5terb8:1,ma5terbate:1,masochist:1,"master-bate":1,masterb8:1,"masterbat*":1,masterbat3:1,masterbate:1,masterbation:1,masterbations:1,masturbate:1,"mo-fo":1,mof0:1,mofo:1,mothafuck:1,mothafucka:1,mothafuckas:1,mothafuckaz:1,"mothafucked ":1,mothafucker:1,mothafuckers:1,mothafuckin:1,"mothafucking ":1,mothafuckings:1,mothafucks:1,"mother fucker":1,motherfuck:1,motherfucked:1,motherfucker:1,motherfuckers:1,motherfuckin:1,motherfucking:1,motherfuckings:1,motherfuckka:1,motherfucks:1,muff:1,mutha:1,muthafecker:1,muthafuckker:1,muther:1,mutherfucker:1,n1gga:1,n1gger:1,nazi:1,nigg3r:1,nigg4h:1,nigga:1,niggah:1,niggas:1,niggaz:1,nigger:1,"niggers ":1,nob:1,"nob jokey":1,nobhead:1,nobjocky:1,nobjokey:1,numbnuts:1,nutsack:1,"orgasim ":1,"orgasims ":1,orgasm:1,"orgasms ":1,p0rn:1,pawn:1,pecker:1,penis:1,penisfucker:1,phonesex:1,phuck:1,phuk:1,phuked:1,phuking:1,phukked:1,phukking:1,phuks:1,phuq:1,pigfucker:1,pimpis:1,piss:1,pissed:1,pisser:1,pissers:1,"pisses ":1,pissflaps:1,"pissin ":1,pissing:1,"pissoff ":1,poop:1,porn:1,porno:1,pornography:1,pornos:1,prick:1,"pricks ":1,pron:1,pube:1,pusse:1,pussi:1,pussies:1,pussy:1,"pussys ":1,rectum:1,retard:1,rimjaw:1,rimming:1,"s hit":1,"s.o.b.":1,sadist:1,schlong:1,screwing:1,scroat:1,scrote:1,scrotum:1,semen:1,sex:1,"sh!+":1,"sh!t":1,sh1t:1,shag:1,shagger:1,shaggin:1,shagging:1,shemale:1,"shi+":1,shit:1,shitdick:1,shite:1,shited:1,shitey:1,shitfuck:1,shitfull:1,shithead:1,shiting:1,shitings:1,shits:1,shitted:1,shitter:1,"shitters ":1,shitting:1,shittings:1,"shitty ":1,skank:1,slut:1,sluts:1,smegma:1,smut:1,snatch:1,"son-of-a-bitch":1,spac:1,spunk:1,s_h_i_t:1,t1tt1e5:1,t1tties:1,teets:1,teez:1,testical:1,testicle:1,tit:1,titfuck:1,tits:1,titt:1,tittie5:1,tittiefucker:1,titties:1,tittyfuck:1,tittywank:1,titwank:1,tosser:1,turd:1,tw4t:1,twat:1,twathead:1,twatty:1,twunt:1,twunter:1,v14gra:1,v1gra:1,vagina:1,viagra:1,vulva:1,w00se:1,wang:1,wank:1,wanker:1,wanky:1,whoar:1,whore:1,willies:1,willy:1,xrated:1,xxx:1}}),module.exports="sf.services.profanity-filter"},{}],27:[function(require,module){var moduleName="sf.services.punctuation";angular.module(moduleName,[]).service("Punctuation",function(_){var punctuation=this;punctuation.properPunctuationString=function(tokens){var initial=_.initial(tokens),last=_.last(tokens);return"'"+initial.join("', '")+"' or '"+last+"'"},punctuation.checkEndingPunctuation=function(sentence){var errors=[],tokens=sentence.split(""),acceptableTokens='.;?!")'.split(""),containsProperEndingPunctuation=_.some(acceptableTokens,function(at){return at===tokens[tokens.length-1]});return containsProperEndingPunctuation||errors.push("Please end your sentence with "+punctuation.properPunctuationString(acceptableTokens)+"."),0===errors.length?null:errors}}),module.exports=moduleName},{}],28:[function(require,module){angular.module("sf.services.user",[]).service("User",function(localStorageService,$analytics){var user=this;user.currentUser=null,user.currentUserKey="currentUser",user.setCurrentUser=function(newUser){null===user.currentUser&&$analytics.eventTrack("Quill-Writer New User Session"),user.currentUser=newUser,localStorageService.set(user.currentUserKey,newUser)},user.getUserFromLocalStorage=function(){return localStorageService.get(user.currentUserKey)}}),module.exports="sf.services.user"},{}]},{},[4]);